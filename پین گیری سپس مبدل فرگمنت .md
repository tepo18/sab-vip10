"routeOnly": True
                    },
                    "tag": "socks-in"
                },
                {
                    "port": 10853,
                    "protocol": "dokodemo-door",
                    "settings": {
                        "address": "1.1.1.1",
                        "network": "tcp,udp",
                        "port": 53
                    },
                    "tag": "dns-in"
                }
            ],
            "outbounds": [
                outbound,
                {
                    "tag": "fragment",
                    "protocol": "freedom",
                    "settings": {
                        "fragment": {
                            "packets": "tlshello",
                            "length": "100-200",
                            "interval": "1-1"
                        },
                        "domainStrategy": "UseIPv4v6"
                    }
                }
            ],
            "routing": {
                "domainStrategy": "IPIfNonMatch",
                "rules": [
                    {
                        "inboundTag": ["dns-in"],
                        "outboundTag": "dns-out",
                        "type": "field"
                    },
                    {
                        "network": "tcp",
                        "outboundTag": "proxy",
                        "type": "field"
                    }
                ]
            }
        }

        fragments.append(fragment)

    return fragments


def save_output(configs):
    while True:
        print("\nSelect output type:\n1. Fragmented Config (for V2Ray)\n2. Simple Raw JSON")
        choice = input("Enter your choice (1 or 2): ").strip()

        file_name = input("Output file name (without extension): ").strip()
        save_path = "/sdcard/Download/almasi98"
        os.makedirs(save_path, exist_ok=True)
        full_path = os.path.join(save_path, f"{file_name}.json")

        if choice == "1":
            output = build_fragment_list(configs)
        else:
            output = configs

        with open(full_path, "w", encoding="utf-8") as f:
            json.dump(output, f, indent=2, ensure_ascii=False)

        print(f"\n✅ Saved to: {full_path}")

        again = input("\nDo you want to export again with same input? (y/n): ").strip().lower()
        if again != "y":
            break


def main():
    print("=" * 40)
    print("Paste your configs (Press ENTER twice to finish):")
    lines = []
    while True:
        line = input()
        if line.strip() == "":
            break
        lines.append(line.strip())

    parsed_configs = []
    for line in lines:
        proto, parsed = parse_link(line)
        if proto:
            parsed_configs.append(parsed)
        else:
            print(f"Skipped: {line}")

    if not parsed_configs:
        print("❌ No valid configs parsed.")
        return

    save_output(parsed_configs)


if name == "main":
    main()`
